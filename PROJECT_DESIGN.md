# BlacklistHub é¡¹ç›®è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

BlacklistHub æ˜¯ä¸€ä¸ªåŸºäº Next.js çš„é»‘åå•ç®¡ç†ç³»ç»Ÿï¼Œæä¾›ç”¨æˆ·ä¸¾æŠ¥ã€å®¡æ ¸ã€å‘å¸ƒå’ŒæŸ¥è¯¢é»‘åå•ä¿¡æ¯çš„å®Œæ•´å·¥ä½œæµç¨‹ã€‚ç³»ç»Ÿé‡‡ç”¨å››çº§æƒé™æ¨¡å‹ï¼Œç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Next.js 14 (App Router)
- **UI ç»„ä»¶åº“**: Ant Design (antd)
- **æ ·å¼**: Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: SWR (æ•°æ®è·å–å’Œç¼“å­˜)
- **ç±»å‹æ£€æŸ¥**: TypeScript
- **HTTP å®¢æˆ·ç«¯**: Axios

### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**: Node.js
- **æ¡†æ¶**: Next.js API Routes
- **æ•°æ®åº“**: MongoDB
- **ODM**: Mongoose
- **è®¤è¯**: JWT (JSON Web Tokens)
- **å¯†ç åŠ å¯†**: bcryptjs

### å¼€å‘å·¥å…·
- **åŒ…ç®¡ç†å™¨**: npm
- **ä»£ç æ ¼å¼åŒ–**: Prettier
- **ä»£ç æ£€æŸ¥**: ESLint
- **ç±»å‹æ£€æŸ¥**: TypeScript

## ğŸ” æƒé™ç³»ç»Ÿè®¾è®¡

### å››çº§æƒé™æ¨¡å‹

```
Reporterï¼ˆä¸¾æŠ¥è€…ï¼‰
    â†“ å¯ä»¥æäº¤é»‘åå•ä¸¾æŠ¥
Reviewerï¼ˆå®¡æ ¸å‘˜ï¼‰  
    â†“ å¯ä»¥å®¡æ ¸ä¸¾æŠ¥å†…å®¹
Adminï¼ˆç®¡ç†å‘˜ï¼‰
    â†“ å¯ä»¥ç®¡ç†æ™®é€šç”¨æˆ·ï¼Œå‘å¸ƒå†…å®¹
Super Adminï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰
    â†“ æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œä¸å¯è¢«åˆ é™¤ï¼Œå¯ç®¡ç†æ‰€æœ‰è§’è‰²
```

### æƒé™è¯¦ç»†è¯´æ˜

#### 1. Reporterï¼ˆä¸¾æŠ¥è€…ï¼‰
- **ä¸»è¦èŒè´£**: æäº¤é»‘åå•ä¸¾æŠ¥ï¼Œå½•å…¥è¿è§„ä¿¡æ¯
- **æƒé™èŒƒå›´**:
  - åˆ›å»ºæ–°çš„é»‘åå•æ¡ç›®ï¼ˆè‰ç¨¿çŠ¶æ€ï¼‰
  - æŸ¥çœ‹è‡ªå·±æäº¤çš„ä¸¾æŠ¥è®°å½•
  - ç¼–è¾‘è‡ªå·±çš„è‰ç¨¿çŠ¶æ€æ¡ç›®

#### 2. Reviewerï¼ˆå®¡æ ¸å‘˜ï¼‰
- **ä¸»è¦èŒè´£**: å®¡æ ¸ä¸¾æŠ¥å†…å®¹ï¼ŒéªŒè¯ä¿¡æ¯çœŸå®æ€§
- **æƒé™èŒƒå›´**:
  - æŸ¥çœ‹æ‰€æœ‰å¾…å®¡æ ¸çš„ä¸¾æŠ¥
  - ä¿®æ”¹ä¸¾æŠ¥çŠ¶æ€ï¼ˆé€šè¿‡/æ‹’ç»/é€€å›ï¼‰
  - æŸ¥çœ‹ç»Ÿè®¡æ•°æ®å’Œå®¡æ ¸å†å²
  - æ‰§è¡ŒçŠ¶æ€æµè½¬æ“ä½œ

#### 3. Adminï¼ˆç®¡ç†å‘˜ï¼‰
- **ä¸»è¦èŒè´£**: ç”¨æˆ·ç®¡ç†ã€å†…å®¹å‘å¸ƒã€åŸºç¡€ç³»ç»Ÿç®¡ç†
- **æƒé™èŒƒå›´**:
  - ç®¡ç†æ™®é€šç”¨æˆ·ï¼ˆReporterã€Reviewerï¼‰
  - ä¿®æ”¹æ™®é€šç”¨æˆ·è§’è‰²
  - åˆ é™¤æ™®é€šç”¨æˆ·
  - ç›´æ¥å‘å¸ƒè‰ç¨¿çŠ¶æ€çš„è®°å½•
  - ä¿®æ”¹å·²å‘å¸ƒçš„è®°å½•
  - å¯¼å‡ºé»‘åå•æ•°æ®
  - è®¿é—®ç”¨æˆ·ç®¡ç†é¡µé¢

#### 4. Super Adminï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰
- **ä¸»è¦èŒè´£**: ç³»ç»Ÿçº§ç®¡ç†ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™
- **æ ¸å¿ƒç‰¹æƒ**:
  - **ç³»ç»Ÿçº§æ§åˆ¶**: æ‹¥æœ‰æ‰€æœ‰ç³»ç»ŸåŠŸèƒ½çš„æœ€é«˜æƒé™
  - **ä¸å¯åˆ é™¤**: å…¶ä»–ç”¨æˆ·æ— æ³•åˆ é™¤è¶…çº§ç®¡ç†å‘˜è´¦æˆ·
  - **æƒé™ç®¡ç†**: å¯ä»¥ç®¡ç†æ‰€æœ‰å…¶ä»–è§’è‰²çš„æƒé™
- **æƒé™èŒƒå›´**:
  - æ‰€æœ‰ Admin æƒé™
  - ç®¡ç†ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆåˆ é™¤ã€ä¿®æ”¹è§’è‰²ï¼‰
  - ä¿®æ”¹ä»»ä½•ç”¨æˆ·çš„è§’è‰²
  - ç³»ç»Ÿé…ç½®å’Œç»´æŠ¤

## ğŸ“Š æ•°æ®æ¨¡å‹è®¾è®¡

### ç”¨æˆ·æ¨¡å‹ (User)
```typescript
{
  _id: ObjectId,
  username: string,           // ç”¨æˆ·å
  password_hash: string,      // å¯†ç å“ˆå¸Œ
  role: UserRole,            // ç”¨æˆ·è§’è‰²
  createdAt: Date,           // åˆ›å»ºæ—¶é—´
  updatedAt: Date            // æ›´æ–°æ—¶é—´
}
```

### é»‘åå•æ¨¡å‹ (Blacklist)
```typescript
{
  _id: ObjectId,
  type: "user" | "ip" | "email" | "phone" | "company" | "other",  // ç±»å‹
  value: string,                                       // å¤±ä¿¡äººåç§°
  company_name?: string,                              // å…¬å¸åç§°ï¼ˆå½“typeä¸ºcompanyæ—¶å¿…å¡«ï¼‰
  reason_code: string,                                // ç†ç”±ä»£ç 
  reason: string,                                     // è¯¦ç»†ç†ç”±
  source: string,                                     // æ¥æº
  region: string,                                     // åœ°åŒº
  risk_level: "low" | "medium" | "high",             // é£é™©ç­‰çº§
  status: "draft" | "pending" | "published" | "rejected" | "retracted", // çŠ¶æ€
  evidence: {                                         // è¯æ®ä¿¡æ¯
    images: string[],                                 // å›¾ç‰‡URLæ•°ç»„
    description?: string,                             // è¯æ®æè¿°
    uploaded_by: ObjectId,                           // ä¸Šä¼ è€…
    uploaded_at: Date                                // ä¸Šä¼ æ—¶é—´
  }[],
  submitter: ObjectId,                               // æäº¤è€…
  reviewer?: ObjectId,                               // å®¡æ ¸è€…
  created_at: Date,                                  // åˆ›å»ºæ—¶é—´
  updated_at: Date,                                  // æ›´æ–°æ—¶é—´
  published_at?: Date                                // å‘å¸ƒæ—¶é—´
}
```

## ğŸ”„ ä¸šåŠ¡æµç¨‹è®¾è®¡

### é»‘åå•æ¡ç›®ç”Ÿå‘½å‘¨æœŸ

```mermaid
graph TD
    A[Reporter åˆ›å»º] --> B[draft è‰ç¨¿]
    B --> C[Reporter æäº¤å®¡æ ¸]
    C --> D[pending å¾…å®¡æ ¸]
    D --> E[Reviewer å®¡æ ¸]
    E --> F{å®¡æ ¸ç»“æœ}
    F -->|é€šè¿‡| G[published å·²å‘å¸ƒ]
    F -->|æ‹’ç»| H[rejected å·²æ‹’ç»]
    F -->|é€€å›| B
    G --> I[Admin å¯æ’¤å›]
    I --> J[retracted å·²æ’¤å›]
    
    B --> K[Admin ç›´æ¥å‘å¸ƒ]
    K --> G
```

### çŠ¶æ€æµè½¬è§„åˆ™

| å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | æƒé™è¦æ±‚ | è¯´æ˜ |
|---------|---------|---------|------|
| draft | pending | Reporter+ | æäº¤å®¡æ ¸ |
| draft | published | Admin+ | ç›´æ¥å‘å¸ƒ |
| pending | published | Reviewer+ | å®¡æ ¸é€šè¿‡ |
| pending | rejected | Reviewer+ | å®¡æ ¸æ‹’ç» |
| pending | draft | Reviewer+ | é€€å›ä¿®æ”¹ |
| published | retracted | Admin+ | æ’¤å›å‘å¸ƒ |

## ğŸ¨ å‰ç«¯æ¶æ„è®¾è®¡

### é¡µé¢ç»“æ„
```
/                          # é¦–é¡µ - é»‘åå•æŸ¥è¯¢
â”œâ”€â”€ /users                 # ç”¨æˆ·åˆ—è¡¨ç®¡ç† (Admin+)
â”œâ”€â”€ /admin/users          # è§’è‰²ç®¡ç† (Admin+)
â”œâ”€â”€ /admin/enums          # æšä¸¾æ•°æ®ç®¡ç† (Admin+)
â””â”€â”€ /api/*                # API è·¯ç”±
```

### ç»„ä»¶æ¶æ„
```
components/
â”œâ”€â”€ NavClient.tsx          # å¯¼èˆªç»„ä»¶
â”œâ”€â”€ NavWithUserInfo.tsx    # å¸¦ç”¨æˆ·ä¿¡æ¯çš„å¯¼èˆª
â””â”€â”€ SearchCard.tsx         # æœç´¢å¡ç‰‡ç»„ä»¶

app/
â”œâ”€â”€ (public)/
â”‚   â””â”€â”€ home/
â”‚       â””â”€â”€ SearchCard.tsx # é¦–é¡µæœç´¢ç»„ä»¶
â”œâ”€â”€ users/
â”‚   â””â”€â”€ page.tsx          # ç”¨æˆ·ç®¡ç†é¡µé¢
â””â”€â”€ admin/
    â”œâ”€â”€ users/page.tsx    # è§’è‰²ç®¡ç†é¡µé¢
    â””â”€â”€ enums/page.tsx    # æšä¸¾ç®¡ç†é¡µé¢
```

### çŠ¶æ€ç®¡ç†
- **SWR**: ç”¨äºæ•°æ®è·å–ã€ç¼“å­˜å’ŒåŒæ­¥
- **React State**: ç”¨äºç»„ä»¶å†…éƒ¨çŠ¶æ€ç®¡ç†
- **URL State**: ç”¨äºæœç´¢å‚æ•°å’Œåˆ†é¡µçŠ¶æ€

## ğŸ”Œ API è®¾è®¡

### è®¤è¯ç›¸å…³
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/userinfo` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

### ç”¨æˆ·ç®¡ç†
- `GET /api/users` - è·å–ç”¨æˆ·åˆ—è¡¨ (Admin+)
- `PUT /api/users/[id]` - æ›´æ–°ç”¨æˆ·è§’è‰² (Admin+)
- `DELETE /api/users/[id]` - åˆ é™¤ç”¨æˆ· (Admin+)
- `POST /api/users/batch-delete` - æ‰¹é‡åˆ é™¤ç”¨æˆ· (Admin+)

### é»‘åå•ç®¡ç†
- `GET /api/blacklist` - è·å–é»‘åå•åˆ—è¡¨
- `POST /api/blacklist` - åˆ›å»ºé»‘åå•æ¡ç›®
- `PUT /api/blacklist/[id]` - æ›´æ–°é»‘åå•æ¡ç›®
- `DELETE /api/blacklist/[id]` - åˆ é™¤é»‘åå•æ¡ç›®
- `GET /api/blacklist/lookup` - å…¬å¼€æŸ¥è¯¢æ¥å£
- `GET /api/blacklist/export` - å¯¼å‡º CSV (Admin+)
- `GET /api/blacklist/export-json` - å¯¼å‡º JSON (Admin+)

## ğŸ”’ å®‰å…¨è®¾è®¡

### è®¤è¯æœºåˆ¶
- **JWT Token**: ç”¨äºç”¨æˆ·èº«ä»½éªŒè¯
- **Cookie å­˜å‚¨**: Token å­˜å‚¨åœ¨ HttpOnly Cookie ä¸­
- **Token éªŒè¯**: æ¯ä¸ª API è¯·æ±‚éƒ½è¿›è¡Œ Token éªŒè¯

### æƒé™æ§åˆ¶
- **å‰ç«¯æƒé™**: åŸºäºç”¨æˆ·è§’è‰²æ˜¾ç¤º/éšè—åŠŸèƒ½
- **åç«¯æƒé™**: API çº§åˆ«çš„æƒé™éªŒè¯
- **æ•°æ®æƒé™**: ç”¨æˆ·åªèƒ½æ“ä½œæœ‰æƒé™çš„æ•°æ®

### æ•°æ®å®‰å…¨
- **å¯†ç åŠ å¯†**: ä½¿ç”¨ bcryptjs è¿›è¡Œå¯†ç å“ˆå¸Œ
- **è¾“å…¥éªŒè¯**: å‰åç«¯åŒé‡æ•°æ®éªŒè¯
- **SQL æ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨ Mongoose ODM é˜²æ­¢æ³¨å…¥æ”»å‡»

## ğŸ“± ç”¨æˆ·ç•Œé¢è®¾è®¡

### è®¾è®¡åŸåˆ™
- **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **ç”¨æˆ·å‹å¥½**: ç›´è§‚çš„æ“ä½œç•Œé¢å’Œæ¸…æ™°çš„ä¿¡æ¯å±•ç¤º
- **æƒé™å¯è§†åŒ–**: æ ¹æ®ç”¨æˆ·æƒé™åŠ¨æ€æ˜¾ç¤ºåŠŸèƒ½

### ä¸»è¦ç•Œé¢

#### 1. é¦–é¡µæœç´¢ç•Œé¢
- é»‘åå•æŸ¥è¯¢è¡¨å•
- æœç´¢ç»“æœåˆ—è¡¨
- åˆ†é¡µå’Œç­›é€‰åŠŸèƒ½
- é£é™©ç­‰çº§æŒ‡ç¤ºæ¡

#### 2. ç”¨æˆ·ç®¡ç†ç•Œé¢
- ç”¨æˆ·åˆ—è¡¨è¡¨æ ¼
- è§’è‰²ä¿®æ”¹ä¸‹æ‹‰èœå•
- æ‰¹é‡åˆ é™¤åŠŸèƒ½
- æƒé™æ§åˆ¶æŒ‰é’®

#### 3. è§’è‰²ç®¡ç†ç•Œé¢
- ç®€åŒ–çš„è§’è‰²ä¿®æ”¹ç•Œé¢
- æƒé™éªŒè¯å’Œé”™è¯¯å¤„ç†

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´

### ç¯å¢ƒé…ç½®
```env
MONGODB_URI=mongodb://localhost:27017/blacklist
JWT_SECRET=your-jwt-secret-key
NODE_ENV=production
```

### åˆå§‹åŒ–è„šæœ¬
- `scripts/createAdmin.ts` - åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
- `scripts/createSuperAdmin.ts` - åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·

### é»˜è®¤è´¦æˆ·
- **è¶…çº§ç®¡ç†å‘˜**: `superadmin` / `superadmin123456`

## ğŸ“ˆ æ‰©å±•æ€§è®¾è®¡

### æ°´å¹³æ‰©å±•
- æ— çŠ¶æ€ API è®¾è®¡ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡
- MongoDB æ”¯æŒåˆ†ç‰‡å’Œå‰¯æœ¬é›†
- å‰ç«¯é™æ€èµ„æºå¯éƒ¨ç½²åˆ° CDN

### åŠŸèƒ½æ‰©å±•
- æ’ä»¶åŒ–çš„æƒé™ç³»ç»Ÿ
- å¯é…ç½®çš„å·¥ä½œæµç¨‹
- å¤šç§Ÿæˆ·æ”¯æŒ
- å®¡è®¡æ—¥å¿—ç³»ç»Ÿ

## ğŸ”§ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜
npx tsx scripts/createSuperAdmin.ts
```

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹æ£€æŸ¥
- éµå¾ª ESLint å’Œ Prettier è§„èŒƒ
- ç»„ä»¶å’Œå‡½æ•°ä½¿ç”¨ JSDoc æ³¨é‡Š
- API æ¥å£ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†

## ğŸ“‹ æƒé™ç³»ç»Ÿå®ç°ç»†èŠ‚

### æƒé™å¸¸é‡å®šä¹‰
```typescript
export const PERMISSIONS = {
  // åŸºç¡€æƒé™æ£€æŸ¥
  CAN_ACCESS_USER_MANAGEMENT: (role: UserRole): boolean =>
    ["admin", "super_admin"].includes(role),

  CAN_DELETE_USERS: (role: UserRole): boolean =>
    ["admin", "super_admin"].includes(role),

  CAN_CHANGE_USER_ROLES: (role: UserRole): boolean =>
    ["admin", "super_admin"].includes(role),

  // è¶…çº§ç®¡ç†å‘˜ç‰¹æƒ
  CAN_DELETE_SUPER_ADMINS: (_role: UserRole): boolean => false,
  CAN_DELETE_ADMINS: (role: UserRole): boolean => role === "super_admin",
  CAN_CHANGE_ADMIN_ROLES: (role: UserRole): boolean => role === "super_admin",

  // ç»†ç²’åº¦æƒé™æ§åˆ¶
  CAN_DELETE_USER_BY_ROLE: (currentRole: UserRole, targetRole: UserRole): boolean => {
    if (targetRole === "super_admin") return false;
    if (targetRole === "admin") return currentRole === "super_admin";
    return ["admin", "super_admin"].includes(currentRole);
  },

  CAN_CHANGE_USER_ROLE_BY_ROLE: (currentRole: UserRole, targetRole: UserRole): boolean => {
    if (["admin", "super_admin"].includes(targetRole)) {
      return currentRole === "super_admin";
    }
    return ["admin", "super_admin"].includes(currentRole);
  },
};
```

### è§’è‰²é€‰é¡¹é…ç½®
```typescript
export const USER_ROLE_OPTIONS = [
  { label: "Reporter", value: "reporter" },
  { label: "Reviewer", value: "reviewer" },
  { label: "Admin", value: "admin" },
  { label: "Super Admin", value: "super_admin" },
];
```

## ğŸ¯ é»‘åå•ä¸šåŠ¡é€»è¾‘

### ç†ç”±ä»£ç åˆ†ç±»
```typescript
const REASON_CODES = {
  // æ¬ºè¯ˆç±»
  "fraud.payment": "æ”¯ä»˜æ¬ºè¯ˆ",
  "fraud.chargeback": "æ‹’ä»˜æ¬ºè¯ˆ",
  "fraud.identity": "èº«ä»½æ¬ºè¯ˆ",
  "fraud.account": "è´¦æˆ·æ¬ºè¯ˆ",

  // æ»¥ç”¨ç±»
  "abuse.spam": "åƒåœ¾ä¿¡æ¯",
  "abuse.harassment": "éªšæ‰°è¡Œä¸º",
  "abuse.phishing": "é’“é±¼æ”»å‡»",
  "abuse.malware": "æ¶æ„è½¯ä»¶",

  // è¿è§„ç±»
  "violation.terms": "è¿åæ¡æ¬¾",
  "violation.policy": "è¿åæ”¿ç­–",
  "violation.legal": "æ³•å¾‹è¿è§„",

  // å®‰å…¨ç±»
  "security.breach": "å®‰å…¨æ¼æ´",
  "security.suspicious": "å¯ç–‘è¡Œä¸º",

  // è´¨é‡ç±»
  "quality.fake": "è™šå‡ä¿¡æ¯",
  "quality.duplicate": "é‡å¤å†…å®¹",

  // å…¶ä»–ç±»
  "other.manual": "äººå·¥æ ‡è®°",
  "other.system": "ç³»ç»Ÿæ£€æµ‹"
};
```

### é£é™©ç­‰çº§å®šä¹‰
- **Low**: ä½é£é™©ï¼Œå¯èƒ½çš„è¿è§„è¡Œä¸º
- **Medium**: ä¸­ç­‰é£é™©ï¼Œç¡®è®¤çš„è¿è§„è¡Œä¸º
- **High**: é«˜é£é™©ï¼Œä¸¥é‡è¿è§„æˆ–é‡å¤è¿è§„

### æ•°æ®åˆå¹¶é€»è¾‘
å½“ç›¸åŒç±»å‹å’Œå¤±ä¿¡äººåç§°çš„è®°å½•å­˜åœ¨æ—¶ï¼š
1. æ£€æŸ¥åœ°åŒºåŒ¹é…æ€§
2. åˆå¹¶æ¥æºä¿¡æ¯
3. å‡çº§é£é™©ç­‰çº§ï¼ˆå–æœ€é«˜çº§åˆ«ï¼‰
4. æ›´æ–°æ—¶é—´çº¿è®°å½•

## ï¿½ è¯æ®ç®¡ç†ç³»ç»Ÿ

### è¯æ®ä¸Šä¼ åŠŸèƒ½
- **å¤šå›¾ç‰‡ä¸Šä¼ **: æ”¯æŒä¸€æ¬¡ä¸Šä¼ æœ€å¤š10å¼ å›¾ç‰‡
- **æ–‡ä»¶ç±»å‹é™åˆ¶**: æ”¯æŒ JPEGã€PNGã€GIFã€WebP æ ¼å¼
- **æ–‡ä»¶å¤§å°é™åˆ¶**: å•ä¸ªæ–‡ä»¶æœ€å¤§ 5MB
- **å®‰å…¨å­˜å‚¨**: æ–‡ä»¶å­˜å‚¨åœ¨æœåŠ¡å™¨æœ¬åœ°ï¼Œç”Ÿæˆå”¯ä¸€æ–‡ä»¶å

### è¯æ®æ•°æ®ç»“æ„
```typescript
interface Evidence {
  images: string[];           // å›¾ç‰‡URLæ•°ç»„
  description?: string;       // è¯æ®æè¿°
  uploaded_by: string;        // ä¸Šä¼ è€…ç”¨æˆ·å
  uploaded_at: Date;         // ä¸Šä¼ æ—¶é—´
}
```

### è¯æ®ç®¡ç†API
- `POST /api/upload` - ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶
- `POST /api/blacklist/[id]/evidence` - æ·»åŠ è¯æ®åˆ°é»‘åå•æ¡ç›®
- `GET /api/blacklist/[id]/evidence` - è·å–è¯æ®åˆ—è¡¨
- `DELETE /api/blacklist/[id]/evidence?index=0` - åˆ é™¤æŒ‡å®šè¯æ®

### æƒé™æ§åˆ¶
- **æ·»åŠ è¯æ®**: è®°å½•åˆ›å»ºè€…ã€å®¡æ ¸å‘˜ã€ç®¡ç†å‘˜å¯ä»¥æ·»åŠ è¯æ®
- **åˆ é™¤è¯æ®**: è¯æ®ä¸Šä¼ è€…ã€ç®¡ç†å‘˜å¯ä»¥åˆ é™¤è¯æ®
- **æŸ¥çœ‹è¯æ®**: æ‰€æœ‰æœ‰æƒé™æŸ¥çœ‹è®°å½•çš„ç”¨æˆ·éƒ½å¯ä»¥æŸ¥çœ‹è¯æ®

## ğŸ¢ å…¬å¸ç±»å‹æ”¯æŒ

### å…¬å¸é»‘åå•ç‰¹æ€§
- **å…¬å¸åç§°å­—æ®µ**: å½“ç±»å‹ä¸º "company" æ—¶ï¼Œå¿…é¡»å¡«å†™å…¬å¸åç§°
- **æœç´¢æ”¯æŒ**: æ”¯æŒæŒ‰å…¬å¸åç§°æœç´¢
- **æ˜¾ç¤ºä¼˜åŒ–**: åœ¨åˆ—è¡¨ä¸­ä¼˜å…ˆæ˜¾ç¤ºå…¬å¸åç§°

### æ•°æ®éªŒè¯
```typescript
// å…¬å¸ç±»å‹ç‰¹æ®ŠéªŒè¯
if (type === "company" && !company_name) {
  return NextResponse.json(
    { message: "å…¬å¸ç±»å‹å¿…é¡»æä¾›å…¬å¸åç§°" },
    { status: 400 }
  );
}
```

## ï¿½ğŸ” æŸ¥è¯¢å’Œæœç´¢åŠŸèƒ½

### å…¬å¼€æŸ¥è¯¢æ¥å£
```typescript
GET /api/blacklist/lookup?type=email&value=test@example.com
GET /api/blacklist/lookup?type=company&value=company_id&company_name=å…¬å¸åç§°
```

å“åº”æ ¼å¼ï¼š
```json
{
  "hit": true,
  "risk_level": "high",
  "active_count": 2,
  "total_count": 3,
  "latest": {
    "reason_code": "fraud.payment",
    "source": "payment_system",
    "company_name": "ç¤ºä¾‹å…¬å¸",
    "created_at": "2024-01-01T00:00:00Z"
  }
}
```

### é«˜çº§æœç´¢åŠŸèƒ½
- **å…³é”®è¯æœç´¢**: æ”¯æŒå¤±ä¿¡äººåç§°ã€ç†ç”±ã€ç†ç”±ä»£ç çš„æ¨¡ç³ŠåŒ¹é…
- **å¤šç»´åº¦ç­›é€‰**: ç±»å‹ã€é£é™©ç­‰çº§ã€çŠ¶æ€ã€æ¥æºã€åœ°åŒº
- **æ—¶é—´èŒƒå›´**: åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ç­›é€‰
- **åˆ†é¡µæ”¯æŒ**: æ”¯æŒå¤§æ•°æ®é‡çš„åˆ†é¡µæŸ¥è¯¢

## ğŸ“Š æ•°æ®å¯¼å‡ºåŠŸèƒ½

### CSV å¯¼å‡ºæ ¼å¼
```csv
ID,ç±»å‹,å¤±ä¿¡äººåç§°,é£é™©ç­‰çº§,ç†ç”±ä»£ç ,ç†ç”±,æ¥æº,åœ°åŒº,çŠ¶æ€,åˆ›å»ºæ—¶é—´,æ›´æ–°æ—¶é—´
```

### JSON å¯¼å‡ºæ ¼å¼
```json
{
  "export_time": "2024-01-01T00:00:00Z",
  "total_count": 1000,
  "data": [
    {
      "_id": "...",
      "type": "email",
      "value": "test@example.com",
      "risk_level": "high",
      "reason_code": "fraud.payment",
      "reason": "æ”¯ä»˜æ¬ºè¯ˆè¡Œä¸º",
      "source": "payment_system",
      "region": "CN",
      "status": "published",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ]
}
```

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### è¾“å…¥éªŒè¯
- **å‰ç«¯éªŒè¯**: è¡¨å•å­—æ®µæ ¼å¼éªŒè¯
- **åç«¯éªŒè¯**: API å‚æ•°ç±»å‹å’ŒèŒƒå›´éªŒè¯
- **æ•°æ®æ¸…ç†**: é˜²æ­¢ XSS æ”»å‡»çš„æ•°æ®æ¸…ç†

### è®¿é—®æ§åˆ¶
- **è·¯ç”±ä¿æŠ¤**: åŸºäºè§’è‰²çš„è·¯ç”±è®¿é—®æ§åˆ¶
- **API ä¿æŠ¤**: æ¯ä¸ª API ç«¯ç‚¹çš„æƒé™éªŒè¯
- **æ•°æ®éš”ç¦»**: ç”¨æˆ·åªèƒ½è®¿é—®æœ‰æƒé™çš„æ•°æ®

### å®¡è®¡æ—¥å¿—
- **æ“ä½œè®°å½•**: è®°å½•æ‰€æœ‰é‡è¦æ“ä½œçš„æ—¶é—´çº¿
- **ç”¨æˆ·è¿½è¸ª**: è®°å½•æ“ä½œç”¨æˆ·å’Œæ—¶é—´
- **çŠ¶æ€å˜æ›´**: è®°å½•çŠ¶æ€å˜æ›´çš„å®Œæ•´å†å²

## ğŸ”§ å¼€å‘å·¥å…·å’Œè„šæœ¬

### ç®¡ç†è„šæœ¬
```bash
# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·
npx tsx scripts/createSuperAdmin.ts

# åˆå§‹åŒ–æšä¸¾æ•°æ®
curl -X POST http://localhost:3000/api/admin/init-enum-data
```

### å¼€å‘å‘½ä»¤
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# ä»£ç æ£€æŸ¥
npm run lint

# ä»£ç æ ¼å¼åŒ–
npm run format
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–
- **ä»£ç åˆ†å‰²**: ä½¿ç”¨ Next.js è‡ªåŠ¨ä»£ç åˆ†å‰²
- **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ Next.js Image ç»„ä»¶
- **ç¼“å­˜ç­–ç•¥**: SWR æä¾›æ™ºèƒ½ç¼“å­˜å’Œé‡æ–°éªŒè¯
- **æ‡’åŠ è½½**: ç»„ä»¶å’Œæ•°æ®çš„æŒ‰éœ€åŠ è½½

### åç«¯ä¼˜åŒ–
- **æ•°æ®åº“ç´¢å¼•**: ä¸ºæŸ¥è¯¢å­—æ®µåˆ›å»ºåˆé€‚çš„ç´¢å¼•
- **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨ lean() æŸ¥è¯¢å‡å°‘å†…å­˜ä½¿ç”¨
- **åˆ†é¡µæŸ¥è¯¢**: é¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®
- **ç¼“å­˜æœºåˆ¶**: å¯¹é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®è¿›è¡Œç¼“å­˜

### æ•°æ®åº“è®¾è®¡ä¼˜åŒ–
```javascript
// ç´¢å¼•è®¾è®¡
db.blacklists.createIndex({ type: 1, value: 1 })
db.blacklists.createIndex({ status: 1, created_at: -1 })
db.blacklists.createIndex({ expires_at: 1 })
db.users.createIndex({ username: 1 }, { unique: true })
```

## ğŸš€ éƒ¨ç½²æ¶æ„

### ç”Ÿäº§ç¯å¢ƒæ¶æ„
```
[Load Balancer]
    â†“
[Next.js App Servers] Ã— N
    â†“
[MongoDB Cluster]
    â†“
[Backup Storage]
```

### ç¯å¢ƒé…ç½®
- **å¼€å‘ç¯å¢ƒ**: æœ¬åœ° MongoDBï¼Œå¼€å‘æ¨¡å¼
- **æµ‹è¯•ç¯å¢ƒ**: äº‘æ•°æ®åº“ï¼Œæµ‹è¯•æ•°æ®é›†
- **ç”Ÿäº§ç¯å¢ƒ**: é«˜å¯ç”¨é›†ç¾¤ï¼Œå®Œæ•´ç›‘æ§

### ç›‘æ§å’Œæ—¥å¿—
- **åº”ç”¨ç›‘æ§**: æ€§èƒ½æŒ‡æ ‡å’Œé”™è¯¯è¿½è¸ª
- **æ•°æ®åº“ç›‘æ§**: æŸ¥è¯¢æ€§èƒ½å’Œèµ„æºä½¿ç”¨
- **ä¸šåŠ¡ç›‘æ§**: ç”¨æˆ·è¡Œä¸ºå’Œç³»ç»Ÿä½¿ç”¨æƒ…å†µ

---

*æœ¬æ–‡æ¡£æè¿°äº† BlacklistHub é¡¹ç›®çš„å®Œæ•´è®¾è®¡æ¶æ„ï¼ŒåŒ…æ‹¬æŠ€æœ¯é€‰å‹ã€æƒé™ç³»ç»Ÿã€æ•°æ®æ¨¡å‹ã€ä¸šåŠ¡æµç¨‹ã€å®‰å…¨è®¾è®¡å’Œéƒ¨ç½²æ–¹æ¡ˆç­‰æ ¸å¿ƒå†…å®¹ã€‚*
